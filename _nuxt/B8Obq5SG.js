import{f as m,ac as h,C as w,D as C,p as b,o as g,w as _,a as n,a5 as y,c0 as v}from"./CqT-yQ2p.js";import{u as j}from"./B_txTBbd.js";import{s as i,h as S,o as p,b as W}from"./B-Wl407J.js";import"./WMrVfZDK.js";import"./DxGKa4za.js";import"./DoMUMXMD.js";import"./CrkdV9i-.js";import"./D_mJjRw_.js";import"./BqXoVrEx.js";import"./CbX2YiQe.js";import"./DlwNc6un.js";import"./NvXfq6Rg.js";const k=S(Error),d=p({message:i()}),x=p({errors:W(d)});function A(s){const c=i().safeParse(s);if(c.success)return c.data;const e=k.safeParse(s);if(e.success)return e.data.message;const t=d.safeParse(s);if(t.success)return t.data.message;const a=x.safeParse(s);return a.success?a.data.errors.map(r=>r.message).join(", "):"Something went wrong"}const E={class:"flex flex-col items-center"},M={name:"CaptchaModal"},T=m({...M,props:{url:{},apiKey:{},isDev:{type:Boolean},body:{}},emits:["close"],setup(s,{emit:c}){const e=s,t=c,a=h("captcha-modal");j();const r=w("captchaRef");async function u(){if(!window||!window.AwsWafCaptcha){a.warn("Window object or AwsWafCaptcha not available. Cannot render captcha.");return}if(await y(),!r.value){a.warn("Captcha ref not available. Cannot render captcha.");return}a.info("Has ref object attached, rendering captcha..."),window.AwsWafCaptcha.renderCaptcha(r.value,{apiKey:e.apiKey,dynamicWidth:!0,disableLanguageSelector:!0,skipTitle:!0,onSuccess:l})}async function l(){if(!window||!window.AwsWafIntegration){a.warn("Window object not available. Cannot submit captcha.");return}try{const o=await window.AwsWafIntegration.fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json",...e.isDev?{"x-dev-mode":"true"}:{}},body:e.body});o?.ok?(a.info("Captcha submission successful."),t("close",{status:"success"})):t("close",{status:"error",error:`Captcha submission failed with status ${o?.status}: ${o?.statusText}`})}catch(o){t("close",{status:"error",error:`Submission failed with error: ${A(o)}`})}}return C(()=>{u()}),(o,P)=>{const f=v;return g(),b(f,{title:"Complete the Captcha",description:"Complete the captcha and click 'Confirm' to submit",close:{onClick:()=>{t("close",{status:"dismiss"})}}},{body:_(()=>[n("div",E,[n("div",{id:"captcha-container",ref_key:"captchaRef",ref:r,class:"w-75"},null,512)])]),_:1},8,["close"])}}}),q=Object.assign(T,{__name:"CoreCaptchaModal"});export{q as default};
